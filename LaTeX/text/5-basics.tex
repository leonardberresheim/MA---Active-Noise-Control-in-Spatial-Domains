% -----------------------------------------------------------------------------
% Fundamentals
% -----------------------------------------------------------------------------
\chapter{Fundamentals}
\label{chap:fundamentals}

\section{Propagation of sound}
For now we assume our acoustic to source to be a point source and thus produce a spherical wave.
\subsection{Wave Equation}
The wave equation or the equation of propagation of acoustic pressure is given by
\begin{equation}
    \frac{1}{c^2}\frac{\partial^2p}{\partial t^2} = \nabla^2p
\end{equation}
where\\
$c$ is the speed of sound,\\
$p$ is the acoustic pressure deviation,\\
$\nabla$ is the Laplace operator.\\
in Cartesian coordinates $(x,y,z)$:
\begin{equation}
    \frac{1}{c^2}\frac{\partial^2p}{\partial t^2} = \frac{\partial^2p}{\partial x^2} + \frac{\partial^2p}{\partial y^2} + \frac{\partial^2p}{\partial z^2},
\end{equation}
in Polar coordinates $(r,\theta, z)$:
\begin{equation}
    \frac{1}{c^2}\frac{\partial^2p}{\partial t^2} = \frac{\partial^2p}{r^2\partial \theta^2} + \frac{\partial^2p}{\partial r^2} + \frac{1}{r}\frac{\partial^2p}{\partial r} + \frac{\partial^2p}{\partial z^2},
\end{equation}
\subsection{Spherical Wave Equation}
\subsection{Pressure wave}
The pressure wave emitted by a single frequency point source of acceleration in free space\cite{Allen1979} is:
\begin{equation}
    P(\omega,\mathbf{X},\mathbf{X'}) = \frac{e^{i\omega(\frac{R}{c}-t)}}{4\pi R},
\end{equation}
where\\
$P=$ pressure,\\
$\omega=2\pi f$,\\
$f=$ frequency,\\
$t=$ time,\\
$\mathbf{R}=|\mathbf{X}-\mathbf{X}'|$,\\
$\mathbf{X}=$ vector talker location $(x,y,z)$,\\
$\mathbf{X}=$ vector microphone location $(x',y',z')$,\\
$i=\sqrt{-1}$,\\
$c=$ speed of sound.
\section{Spherical Harmonics}
"The spherical harmonics are a set of orthogonal spatial basis functions that can be utilized
to decompose any arbitrary function defined on the sphere."\cite{Samarasinghe2018}\\
A homogeneous incident wave field $v(\mathbf{x},k)$ observed at $\mathbf{x}$ can thus be decomposed into\cite{Zhang2019}:
\begin{equation}
    v(\mathbf{x},k)=\sum_{u=0}^\infty \sum_{m=-u}^u\beta_{um}(k)j_u(kr)\Upsilon_{um}(\Phi_x,\Psi_x),
\end{equation}
for any location with spherical coordinates $\mathbf{x}=(x,\Phi_x,\Psi_x)$\\
where\\
$k=2\pi f/c=$ the wave number,\\
$f=$ the frequency,\\
$c=$ the speed of sound,\\
$j_u(.)=$the spherical Bessel function of order $u$,\\
$\beta_um(k)=$ the wave field in the wave domain.\\ 
$\Upsilon_{um}(.)=$ the spherical harmonics,\\
The spherical harmonics function of order $n$ and mode $m$ is defined by\cite{Samarasinghe2018}
\begin{equation}
    \Upsilon_{um}(\Phi_x,\Psi_x) = \mathbf{P}_{n|m|}(cos(\Phi_x))\frac{1}{\sqrt{2\pi}}e^{im\Psi_x},
\end{equation}
where\\
$\mathbf{P}_{n|m|}(cos(\Phi_x))=$ the associated Legendre polynomials.
\section{Simulating an acoustic source in 3D - space}
Other Methods for simulating rooms acoustics among others:
\begin{itemize}
    \item ray/beam tracing
    \item boundary and finite element methods
    \item digital waveguide meshes
    \item spatial sound decomposition based methods
The image source method still remains a sought-after technique.\cite{Samarasinghe2018}
\end{itemize}

\subsection{Image Source Method}
The image model is a method that allows the computation of a source-to-receiver acoustic transfer function in an enclosed 3D-space. Within this method an acoustic wave produced by a source, when crossing a wall, produces an image which then itself is considered as a source for further computation. In a room with several walls each image then also produces an image.\cite{Allen1979}
\\\\
The exact solution to the wave equation in a rectangular, rigid-wall, room is given by the rooms impulse response function also known as the time domain Green's function\cite{Allen1979}:
\begin{equation}
    p(t,\mathbf{X},\mathbf{X'})=\sum_{p=1}^8\sum_{r=-\infty}^\infty\frac{\delta[t-\frac{|\mathbf{R_p}+\mathbf{R_r}|}{c}]}{4\pi|\mathbf{R_p}+\mathbf{R_r}|},
\end{equation}
where\\ 
$c=$ the speed of sound,\\
$\mathbf{R_p}$ represents the eight vectors given by the eight permutations over $\pm$ of
\begin{equation}
    \mathbf{R_p}=(x\pm x', y\pm y', z\pm z')
\end{equation}
r is the integer vector triplet $(n,l,m)$, and
\begin{equation}
    \mathbf{R_r}=2(nL_x, lL_y, mL_z),
\end{equation}
where $(L_x, L_y, L_z)$ are the room dimensions.
\\
\\
In case of non-rigid walls, the solution to the wave equation becomes more complicated and is only conceivable under the assumption that the wall impedance is proportional to $sec(\theta)$, where $\theta$ is the angle incidence of a plane wave with respect to the wall normal, resulting in the Sabine energy absorption coefficient $\alpha$ for a uniform reflection coefficient $\beta$ on a given wall of the form\cite{Allen1979}:
\begin{equation}
    \alpha=1-\beta^2.
\end{equation}
The modified room impulse response transforms into:
\begin{equation}
    p(t,\mathbf{X},\mathbf{X'})=\sum_{p=1}^8\sum_{r=-\infty}^\infty
    \beta_{x1}^{|n-q|}\beta_{x2}^{|n|}\beta_{y1}^{|i-j|}\beta_{y2}^{|i|}\beta_{z1}^{|m-k|}\beta_{z2}^{|m|}
    \frac{\delta[t-\frac{|\mathbf{R_p}+\mathbf{R_r}|}{c}]}{4\pi|\mathbf{R_p}+\mathbf{R_r}|},
\end{equation}
where\\
$p=(q,j,k)$ and $r=(n,l,m)$ are integer 3-vector,\\
$\mathbf{R_p}$ is now expressed in terms of $p$ as
\begin{equation}
    \mathbf{R_p}=(x-x'+2qx', y-y'+2jy,z-z'+2kz').
\end{equation}


\subsection{Spherical Harmonics Based Image Source Method}
The image source method was developed under the assumption that both source and receiver are omnidirectional. As loudspeaker are inherently directional and the use of directional microphones is increasing it is expedient to use a different approach. By modeling the transducers in the spherical harmonics domain with a more realistic directivity pattern it is possible to achieve a more accurate simulation of room acoustics.\cite{Samarasinghe2018}\\
The spherical harmonics based image source method also known as the generalised image source method is given by
\begin{equation}
    \mathbf{P}(k,\mathbf{x}_s,\mathbf{z}^{(r)} = \sum_{v=0}^V\sum_{u=-v}^v\sum_{n=0}^N\sum_{m=-n}^n\sum_{\mathbf{p}=0}^1\sum_{\mathbf{r}=-\infty}^\infty\beta_{nm}(k)\\
    \times (-1)^...
\end{equation}

\\
\\The advantages of the image source method are its relatively simple algorithmic implementation, its high degree of flexibility - many parameter can be set within the software - as well as its ability to generate a good approximation of the room impulse response. It nevertheless comes with its impediments such as its restriction to rectangular rooms and it's inability to model diffraction.\cite{Samarasinghe2018}